<% content_for :title, "Engines for Sale - Find New & Used Car Engines" %>
<% content_for :meta_description, "Shop high-quality car engines for sale, including petrol, diesel, hybrid, and electric engines. Get the best deals on powerful and fuel-efficient engines!" %>
<% content_for :meta_keywords, "car engines, engines for sale, used engines, new engines, V8 engine, diesel engine, hybrid engine, performance engines" %>

<% content_for :meta_og_title, "Engines for Sale - Best Deals on Car Engines" %>
<% content_for :meta_og_description, "Browse a wide selection of high-quality petrol, diesel, hybrid, and electric engines. Find the perfect engine for your vehicle today!" %>
<% content_for :meta_og_image, "https://res.cloudinary.com/drxr1eiwp/image/upload/v1735304802/s-l1600_2_pgnwbn.webp" %>


<div class="content-wrapper">
  <div class="makes-section">
    <%= render "shared/index_engine_filter" %>
  </div>
  <div class="main-content">
    <div class="engines">
        <% if  @paginated_items.any? %>
          <% @paginated_items.each do |engine| %>
          <div class="card">
              <%= link_to engine_path(engine) do %>
                <% if engine.engineable.present? && engine.engineable.photos.any? %>
                  <%= image_tag engine.engineable.photos.first, alt: engine.title, height: 250, width: 300, class: "engine-image" %>
                <% else %>
                  <div style="height: 250px; width: 300px; display: flex; align-items: center; justify-content: center; background: #eee;">
                    <span>Deleted or no photos</span>
                  </div>
                <% end %>
              <% end %>

              <div class="card-info">
                <%= link_to engine_path(engine), style: "text-decoration: none;" do %>
                  <h4><%= engine.title %></h4>
                  <p class="price">Price: <%= number_to_currency(engine.price > 3000 ? engine.price - 2770 : engine.price) %></p>
                <% end %>
               
              <% if engine.engineable.is_a?(CarEngine) || engine.engineable.is_a?(TruckEngine) %>
                  <p>
                    <i class="fas fa-tachometer-alt"></i>
                    Millage: <%= engine.engineable.mileage %> Mi
                  </p>
                   <%= form_with url: cart_add_item_path, method: :post, data: { turbo: true } do |f| %>
                      <%= hidden_field_tag :engine_id, engine.id %>
                      <div class="d-none"><%= f.number_field :quantity, value: 1, min: 1 %></div>
                      <%= f.submit "Add to Cart", class: "btn btn-primary" %>
                    <% end %>
                <% else %>
                  <p>
                    <i class="fas fa-bolt"></i>
                    Power: <%= engine.engineable.power %> HP
                  </p>
                  
                  <%= form_with url: cart_add_item_path, method: :post, data: { turbo: true } do |f| %>
                    <%= hidden_field_tag :engine_id, engine.id %>
                    <div class="d-none"><%= f.number_field :quantity, value: 1, min: 1 %></div>
                    <%= f.submit "Add to Cart", class: "btn btn-primary" %>
                  <% end %>
                <% end %>

              </div>
            </div>
          <% end %>
          <% else %>
            <div style="margin: 30px;">
              <h1>Search Results</h1>
              <p>It seems we can't find an engines with name: <strong style="text-decoration: underline; font-size: 1.1rem;"> <%= params[:query]%></strong></p>
            </div>
          <% end %>
      </div>
      <div class="pagination-container">
        <%= paginate @paginated_items %>
      </div>
    </div>
  </div>

</div>
<div class="used-car-promo">
    <div class="promo-content">
        <h2>Find Your Perfect Engine with AutoBidSeller</h2>
        <p>
            Whether you're restoring a classic car, upgrading your truck, or repowering your boat,
            AutoBidSeller offers a diverse selection of used and rebuilt engines.
            Find reliable performance at competitive prices, backed by our commitment to quality.
        </p>
        <ul>
            <li><strong>Wide Selection:</strong> Discover engines for cars, trucks, and boats.</li>
            <li><strong>Quality Assurance:</strong> Rigorous inspection and testing of all engines.</li>
            <li><strong>Competitive Prices:</strong> Get the best value for your investment.</li>
            <li><strong>Expert Support:</strong> Our team is ready to help you find the right engine.</li>
        </ul>
        <%= link_to "Explore Engines", engines_path, class: "btn-cta" %>
    </div>
    <div class="promo-image">
        <%= image_tag "pablo.jpg", alt: "Illustration of a happy family with a used car", style: "max-height: 500px" %>
    </div>
</div>